const _=Math.min,I=Math.max,R=Math.round,x=Math.floor,O=t=>({x:t,y:t});function $(t){const{x:e,y:n,width:r,height:o}=t;return{width:r,height:o,top:n,left:e,right:e+r,bottom:n+o,x:e,y:n}}function A(t){return V(t)?(t.nodeName||"").toLowerCase():"#document"}function g(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function B(t){var e;return(e=(V(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function V(t){return t instanceof Node||t instanceof g(t).Node}function q(t){return t instanceof Element||t instanceof g(t).Element}function C(t){return t instanceof HTMLElement||t instanceof g(t).HTMLElement}function D(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof g(t).ShadowRoot}function W(t){const{overflow:e,overflowX:n,overflowY:r,display:o}=L(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(o)}function U(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function k(t){return["html","body","#document"].includes(A(t))}function L(t){return g(t).getComputedStyle(t)}function K(t){if(A(t)==="html")return t;const e=t.assignedSlot||t.parentNode||D(t)&&t.host||B(t);return D(e)?e.host:e}function H(t){const e=K(t);return k(e)?t.ownerDocument?t.ownerDocument.body:t.body:C(e)&&W(e)?e:H(e)}function F(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=H(t),c=o===((r=t.ownerDocument)==null?void 0:r.body),i=g(o);return c?e.concat(i,i.visualViewport||[],W(o)?o:[],i.frameElement&&n?F(i.frameElement):[]):e.concat(o,F(o,[],n))}function P(t){const e=L(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const o=C(t),c=o?t.offsetWidth:n,i=o?t.offsetHeight:r,s=R(n)!==c||R(r)!==i;return s&&(n=c,r=i),{width:n,height:r,$:s}}function N(t){return q(t)?t:t.contextElement}function M(t){const e=N(t);if(!C(e))return O(1);const n=e.getBoundingClientRect(),{width:r,height:o,$:c}=P(e);let i=(c?R(n.width):n.width)/r,s=(c?R(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const X=O(0);function Y(t){const e=g(t);return!U()||!e.visualViewport?X:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function j(t,e,n){return!1}function z(t,e,n,r){e===void 0&&(e=!1);const o=t.getBoundingClientRect(),c=N(t);let i=O(1);e&&(i=M(t));const s=j()?Y(c):O(0);let a=(o.left+s.x)/i.x,u=(o.top+s.y)/i.y,v=o.width/i.x,p=o.height/i.y;if(c){const y=g(c),d=r;let w=y,f=w.frameElement;for(;f&&r&&d!==w;){const m=M(f),l=f.getBoundingClientRect(),h=L(f),b=l.left+(f.clientLeft+parseFloat(h.paddingLeft))*m.x,E=l.top+(f.clientTop+parseFloat(h.paddingTop))*m.y;a*=m.x,u*=m.y,v*=m.x,p*=m.y,a+=b,u+=E,w=g(f),f=w.frameElement}}return $({width:v,height:p,x:a,y:u})}function G(t,e){let n=null,r;const o=B(t);function c(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,a){s===void 0&&(s=!1),a===void 0&&(a=1),c();const{left:u,top:v,width:p,height:y}=t.getBoundingClientRect();if(s||e(),!p||!y)return;const d=x(v),w=x(o.clientWidth-(u+p)),f=x(o.clientHeight-(v+y)),m=x(u),h={rootMargin:-d+"px "+-w+"px "+-f+"px "+-m+"px",threshold:I(0,_(1,a))||1};let b=!0;function E(T){const S=T[0].intersectionRatio;if(S!==a){if(!b)return i();S?i(!1,S):r=setTimeout(()=>{i(!1,1e-7)},1e3)}b=!1}try{n=new IntersectionObserver(E,{...h,root:o.ownerDocument})}catch{n=new IntersectionObserver(E,h)}n.observe(t)}return i(!0),c}function J(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:c=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:a=!1}=r,u=N(t),v=o||c?[...u?F(u):[],...F(e)]:[];v.forEach(l=>{o&&l.addEventListener("scroll",n,{passive:!0}),c&&l.addEventListener("resize",n)});const p=u&&s?G(u,n):null;let y=-1,d=null;i&&(d=new ResizeObserver(l=>{let[h]=l;h&&h.target===u&&d&&(d.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(e)})),n()}),u&&!a&&d.observe(u),d.observe(e));let w,f=a?z(t):null;a&&m();function m(){const l=z(t);f&&(l.x!==f.x||l.y!==f.y||l.width!==f.width||l.height!==f.height)&&n(),f=l,w=requestAnimationFrame(m)}return n(),()=>{var l;v.forEach(h=>{o&&h.removeEventListener("scroll",n),c&&h.removeEventListener("resize",n)}),p==null||p(),(l=d)==null||l.disconnect(),d=null,a&&cancelAnimationFrame(w)}}export{J as a};
